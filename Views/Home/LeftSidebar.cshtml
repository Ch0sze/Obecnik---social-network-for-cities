<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link rel="stylesheet" href="~/css/SidebarStyles.css" asp-append-version="true" />

<div class="sidebar-sb">
    <!-- Logo -->
    <div class="logo-container-sb">
        <img src="~/image.png" alt="Logo">
        <h4>OBECNÍK</h4>
    </div>

    <!-- Dynamic Avatar Container (left sidebar) -->
    <div class="avatar-container-sb" id="user-list-left-sb"></div>

    <!-- Scrollable Navigation (fills remaining height) -->
    <div class="nav-container-sb" id="nav-links-sb">
        <!-- Dynamic content via JS -->
    </div>
</div>

<script>
    // Navigation items (with dot as a parameter)
    let navItems = [
        { icon: '', label: 'Obecné', link: '#', active: false, dot: true },
    ];

    // Users (now with dot parameter)
    let users = [
        { name: "Lhotka", image: "/Images/GenericCommunity.png", dot: true },
    ];

    const navContainer = document.getElementById('nav-links-sb');

    // Render avatars dynamically (left sidebar)
    function renderLeftAvatars() {
        const userList = document.getElementById('user-list-left-sb');
        userList.innerHTML = '';

        users.forEach((user, index) => {
            const item = document.createElement('div');
            item.className = 'user-item-sb';
            item.innerHTML = `
                <div class="avatar-btn-container-sb" onclick="onAvatarClick(${index})">
                    <button class="avatar-btn-sb">
                        <img src="${user.image}" alt="${user.name}">
                    </button>
                    <span class="text-sb">${user.name}</span>
                    ${user.dot ? `<span class="dot-sb ms-auto"></span>` : ''}
                </div>
            `;
            userList.appendChild(item);
        });
    }

    // Render navigation dynamically (left sidebar)
    function renderNav() {
        navContainer.innerHTML = '';

        navItems.forEach((item, index) => {
            const div = document.createElement('div');
            div.className = `nav-item-sb${item.active ? ' active-sb' : ''}`;
            div.dataset.index = index;

            div.innerHTML = `
                <a href="${item.link}" onclick="updateDot(${index})">
                    ${item.icon ? `<span class="material-icons me-3">${item.icon}</span>` : '<span class="material-icons me-3" style="opacity: 0;">place</span>'}
                    <span class="text-sb">${item.label}</span>
                    ${item.dot ? `<span class="dot-sb ms-auto"></span>` : ''}
                </a>
            `;

            navContainer.appendChild(div);
        });
    }

    // Update dot indicator on nav click
    function updateDot(index) {
        navItems = navItems.map((item, i) => ({
            ...item,
            dot: i === index
        }));
        renderNav();
    }

    // Handle avatar click and update dots for avatars
    function onAvatarClick(index) {
        // Update the dot state
        users = users.map((user, i) => ({
            ...user,
            dot: i === index
        }));
        renderLeftAvatars();
    }

    // Initial render
    renderLeftAvatars();
    renderNav();
</script>

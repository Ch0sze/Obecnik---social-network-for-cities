<div class="mt-3 w-75 justify-content-center">
    <button id="OpenContributionButton" type="button" class="btn btn-default">
        O co byste se chtěli podělit ...
        <i class="bi bi-envelope-arrow-up-fill"></i>
    </button>
    
    <!-- Form for adding contributions, initially hidden -->
    <div id="contributionFormContainer" style="display: block;" class="mt-3">
        <form id="contributionForm">
            <div class="form-group">
                <textarea id="contentInput" class="form-control" rows="3" required placeholder="Napište svůj příspěvek..."></textarea>
            </div>
            <button type="submit" class="btn btn-primary mt-2">Odeslat</button>
        </form>
    </div>
    
    <div id="contributionsContainer" class="mt-3"></div>
</div>


<script>
        const avatarPath = "@Url.Content("~/Images/GenericAvatar.png")";
        const userName = '@User.Identity?.Name';
        
        document.getElementById('OpenContributionButton').addEventListener('click', function() {
            const formContainer = document.getElementById('contributionFormContainer');
            if (formContainer.style.display === 'none' || formContainer.style.display === ''){
                formContainer.style.display = 'block';
            }
            else formContainer.style.display = 'none';
            });
        
        document.getElementById('contributionForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent page reload
        
            const contentInput = document.getElementById('contentInput');
            const message = contentInput.value.trim();
            
            if (message === "") return; // Prevent empty messages
            
            const now = new Date();
            const formattedDate = now.toLocaleDateString(); // Format the date
            const formattedTime = now.toLocaleTimeString(); // Format the time
        
            // Create a new post element
            const postDiv = document.createElement('div');
            postDiv.className = 'mt-3 p-3 border rounded shadow-sm';
            postDiv.innerHTML = `
                <div class="d-flex align-items-start">
                    <div>
                        <div>
                            <img src="${avatarPath}" alt="Avatar" 
                                 style="width: 30px; height: 30px; user-select: none; pointer-events: none;"/>
                            <strong>${userName}</strong> 
                            <small class="text-muted" >${formattedDate} v ${formattedTime}</small> <!-- Add date and time -->
                        </div>
                        <p class="mb-0 mt-3 message-container" style="font-size: small;width: 100%;
                        max-width: 75vh; overflow-wrap: break-word; word-wrap: break-word; white-space: pre-wrap;
                        overflow: auto;">${message}</p>
                    </div>
                    <div class="ms-auto">
                                <button type="button" class="btn btn-link p-0 border-0" style="pointer-events: none;">
                                    <i class="bi bi-three-dots-vertical" style="pointer-events: auto;"></i>
                                </button>
                            </div>
                </div>
            `;
        
            // Add the post to the container
            document.getElementById('contributionsContainer').prepend(postDiv);
        
            // Clear the input field
            contentInput.value = '';
        });
</script>